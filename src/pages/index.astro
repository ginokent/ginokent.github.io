---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';
import { formatDateShort } from '../lib/i18n';

// 日本語記事のみ（en/ で始まらない）
const posts = (await getCollection('posts', ({ data, slug }) => !data.draft && !slug.startsWith('en/')))
  .sort((a, b) => b.data.publishedAt.valueOf() - a.data.publishedAt.valueOf());
---

<BaseLayout title="ginokent Blog" lang="ja" canonicalPath="/">
  <ul class="post-list">
    {posts.map((post) => (
      <li class="post-item">
        <time class="post-date" datetime={post.data.publishedAt.toISOString()}>
          {formatDateShort(post.data.publishedAt)}
        </time>
        <a href={`/posts/${post.slug}`} class="post-title-link">
          {post.data.title}
        </a>
      </li>
    ))}
  </ul>

  {posts.length === 0 && (
    <p style="color: var(--text-secondary); text-align: center; padding: 3rem 0;">
      記事がまだありません
    </p>
  )}
</BaseLayout>
